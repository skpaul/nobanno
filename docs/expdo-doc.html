<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ExPDO Full Documentation</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; background: #f9f9f9; }
        h1, h2, h3 { color: #2c3e50; }
        code, pre { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; }
        pre { padding: 1em; overflow-x: auto; }
        .tip { background: #e7f7e7; border-left: 4px solid #27ae60; padding: 1em; margin: 1em 0; }
        .warn { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1em; margin: 1em 0; }
    </style>
</head>
<body>
    <h1>ExPDO Full Documentation</h1>
    <p><code>ExPDO</code> is an extended PDO class for MySQL, providing convenient, secure, and flexible methods for database operations. It supports associative arrays, objects, parameterized queries, and includes helpers for SQL generation.</p>

    <h2>1. Constructor & Connection</h2>
    <pre><code>use Nobanno\ExPDO;
$db = new ExPDO('localhost', 'database', 'user', 'password');
</code></pre>
    <ul>
        <li>Sets <code>ERRMODE_EXCEPTION</code>, disables emulated prepares, uses utf8, and buffered queries.</li>
    </ul>

    <h2>2. Insert Methods</h2>
    <ul>
        <li><b>insert($sql, $data = null)</b> <i>(deprecated, use executeInsert)</i></li>
        <li><b>executeInsert($sql, $data = null)</b></li>
        <li><b>insertAuto($table, $data, $isParam = true)</b> <i>(deprecated, use insertRecord)</i></li>
        <li><b>insertRecord($table, $data, $isParam = true)</b></li>
    </ul>
    <pre><code>// Parameterized insert
$sql = "INSERT INTO users (name, email) VALUES (:name, :email)";
$db->executeInsert($sql, ['name' => 'Alice', 'email' => 'alice@example.com']);

// Auto insert
$db->insertRecord('users', ['name' => 'Bob', 'email' => 'bob@example.com']);
</code></pre>

    <h2>3. Select Methods</h2>
    <ul>
        <li><b>fetchAssoc($sql, $args = null)</b>: Single row as assoc array</li>
        <li><b>fetchAssocs($sql, $args = null)</b>: Multiple rows as assoc arrays</li>
        <li><b>fetchObject($sql, $args = null)</b>: Single row as object</li>
        <li><b>fetchObjects($sql, $args = null)</b>: Multiple rows as objects</li>
        <li><b>fetchClass($sql, $class, $args = null)</b>: Single row as class instance</li>
        <li><b>fetchClasses($sql, $class, $args = null)</b>: Multiple rows as class instances</li>
        <li><b>fetchColumnValues($sql, $args = null, $col = 0)</b>: Array of values from one column</li>
    </ul>
    <pre><code>// Fetch single user as assoc array
$user = $db->fetchAssoc("SELECT * FROM users WHERE id = :id", ['id' => 1]);

// Fetch all users as objects
$users = $db->fetchObjects("SELECT * FROM users");
</code></pre>

    <h2>4. Update Methods</h2>
    <ul>
        <li><b>update($sql, $data = null)</b> <i>(deprecated, use executeUpdate)</i></li>
        <li><b>executeUpdate($sql, $data = null)</b></li>
        <li><b>updateAuto($table, $data, $where, $isParam = true)</b> <i>(deprecated, use updateRecord)</i></li>
        <li><b>updateRecord($table, $data, $where, $isParam = true)</b></li>
    </ul>
    <pre><code>// Parameterized update
$sql = "UPDATE users SET name = :name WHERE id = :id";
$db->executeUpdate($sql, ['name' => 'Alice', 'id' => 1]);

// Auto update
$db->updateRecord('users', ['name' => 'Bob'], ['id' => 2]);
</code></pre>

    <h2>5. Delete Methods</h2>
    <ul>
        <li><b>delete($sql, $data = null)</b></li>
    </ul>
    <pre><code>// Parameterized delete
$sql = "DELETE FROM users WHERE id = :id";
$db->delete($sql, ['id' => 1]);
</code></pre>

    <h2>6. SQL Preparation Helpers</h2>
    <ul>
        <li><b>prepareInsertSql($data, $table, $isParam = true)</b></li>
        <li><b>prepareSelectSql($columns, $table, $where, $isParam)</b></li>
        <li><b>prepareUpdateSql($table, $data, $where, $isParam)</b></li>
        <li><b>prepareDeleteSql($where, $table, $isParam)</b></li>
        <li><b>prepareWhereClause($where, $isParam)</b></li>
    </ul>
    <pre><code>// Example: Generate insert SQL
$sql = ExPDO::prepareInsertSql(['name' => 'Alice', 'email' => 'alice@example.com'], 'users');
// Returns: INSERT INTO users(`name`, `email`) VALUES(:name, :email)
</code></pre>

    <h2>7. Utility & Error Handling</h2>
    <ul>
        <li>All methods throw <code>PDOException</code> with detailed backtrace on error.</li>
        <li>Supports both arrays and objects for data/parameters.</li>
    </ul>

    <h2>8. Best Practices</h2>
    <ul>
        <li>Always use parameterized queries for user input.</li>
        <li>Use the auto methods (<code>insertRecord</code>, <code>updateRecord</code>) for convenience and safety.</li>
        <li>Handle exceptions with try/catch.</li>
        <li>Review SQL generated by helpers for complex queries.</li>
    </ul>

    <h2>9. Example: Full CRUD</h2>
    <pre><code>// Create
$userId = $db->insertRecord('users', ['name' => 'Alice', 'email' => 'alice@example.com']);
// Read
$user = $db->fetchAssoc('SELECT * FROM users WHERE id = :id', ['id' => $userId]);
// Update
$db->updateRecord('users', ['name' => 'Alicia'], ['id' => $userId]);
// Delete
$db->delete('DELETE FROM users WHERE id = :id', ['id' => $userId]);
</code></pre>

    <h2>10. References</h2>
    <ul>
        <li><a href="https://www.php.net/manual/en/class.pdo.php" target="_blank">PHP: PDO</a></li>
        <li><a href="https://www.php.net/manual/en/pdo.prepare.php" target="_blank">PHP: PDO::prepare</a></li>
        <li><a href="https://www.php.net/manual/en/pdo.constants.php" target="_blank">PHP: PDO Constants</a></li>
    </ul>
</body>
</html>
